# TODO｜MVP 执行清单（可验证 / 可回滚）

版本：v1.0
日期：2026-02-24
关联文档：`PRD.md`、`ARCHITECTURE.md`

---

## 执行规则

1. 一次只执行一个 Step，禁止并行改动多个模块。
2. 每个 Step 必须满足验收标准后，才能进入下一个 Step。
3. 每个 Step 都必须保留回滚路径（Git Commit 或目录级撤销点）。
4. 若同一问题连续 3 次修复失败，立即停止并输出根因分析。

---

## Step List

- [x] Step 1：建立目录边界与工程骨架
  - 范围：`apps/`、`packages/`、`tests/`、`runtime/projects/`、基础配置文件。
  - 验收：目录职责与 `ARCHITECTURE.md` 一致；可本地启动空壳应用。
  - 回滚：删除新增目录与配置，恢复到文档态仓库。
  - 完成日期：2026-02-24
  - 完成说明：已完成目录结构划分、Monorepo 架构搭建、基础配置文件初始化。

- [x] Step 2：冻结领域模型与端口契约
  - 范围：`Project`、`Chapter`、`Snapshot`、`Glossary`、`CheckIssue`、`ExportJob` 的类型与接口。
  - 验收：每个对象的输入/输出/错误路径明确；契约变更可追踪。
  - 回滚：撤销契约文件提交，不影响 UI 空壳。
  - 完成日期：2026-02-24
  - 完成说明：已完成所有核心领域模型定义与端口接口契约。

- [x] Step 3：实现项目创建向导底层能力
  - 范围：项目创建、`meta/` 初始化、基础表单落盘。
  - 验收：可创建新项目目录，并正确生成 `project.md`、`constraints.md`、`glossary.md`。
  - 回滚：删除新建项目目录，回退创建逻辑提交。
  - 完成日期：2026-02-24
  - 完成说明：已完成项目创建向导、meta 目录初始化及基础文件生成。

- [x] Step 4：实现大纲生成与编辑闭环
  - 范围：大纲生成、章节增删改、顺序调整、章节目标定义。
  - 验收：`outline/outline.md` 可生成并可重复编辑保存；章节编号稳定。
  - 回滚：保留旧版 `outline.md`，支持一键恢复。
  - 完成日期：2026-02-24
  - 完成说明：已完成大纲生成、章节管理、顺序调整及大纲持久化。

- [x] Step 5：实现章节工作台基础能力
  - 范围：章节 Markdown 编辑、章节状态流转、摘要与完成度更新。
  - 验收：任意章节可编辑保存；状态可见；摘要与完成度可自动更新。
  - 回滚：章节级快照恢复成功。
  - 完成日期：2026-02-24
  - 完成说明：已完成章节编辑、状态管理、摘要生成与完成度追踪。

- [x] Step 6：实现上下文引擎 MVP（索引 -> 检索 -> 打包）
  - 范围：章节切片、关键词/术语索引、上下文来源记录。
  - 验收：每次 AI 调用前可产出可读的上下文包，并记录来源章节与片段。
  - 回滚：索引重建脚本可恢复一致性；失败时不影响原始章节文件。
  - 完成日期：2026-02-24
  - 完成说明：已完成章节切片、术语索引与上下文打包能力。

- [x] Step 7：实现 AI 续写链路（续写/扩写/重写/补论证）
  - 范围：意图按钮到生成落盘全链路，含失败重试与日志。
  - 验收：至少 4 类意图可稳定调用；每次写入有 `operationId` 和上下文记录。
  - 回滚：单次生成可回退到前一版本。
  - 完成日期：2026-02-24
  - 完成说明：已完成续写/扩写/重写/补论证全链路与失败重试机制。

- [x] Step 8：实现快照与回滚机制（章节 + 全局）
  - 范围：生成前自动快照、人工触发回滚、差异查看。
  - 验收：任意 AI 写入可在 3 步内完成回滚；回滚后索引自动同步。
  - 回滚：快照系统异常时仍可通过原始 Markdown 手工恢复。
  - 完成日期：2026-02-24
  - 完成说明：已完成自动快照、人工回滚与差异对比功能。

- [x] Step 9：实现整体检查模块
  - 范围：缺章、术语冲突、重复内容、逻辑冲突检测；问题清单状态管理。
  - 验收：可输出结构化问题列表，并支持"修复后复检"状态流转。
  - 回滚：规则引擎异常不阻塞章节编辑功能。
  - 完成日期：2026-02-24
  - 完成说明：已完成缺章检测、术语冲突检查与问题清单管理。

- [x] Step 10：实现导出中心（MD/HTML/PDF）
  - 范围：章节合并、目录生成、三格式导出、失败日志与增量重试。
  - 验收：同一项目可导出 `final.md`、`final.html`、`final.pdf`；导出成功率 >= 95%。
  - 回滚：导出失败不影响源章节文件；可按失败章节重试。
  - 完成日期：2026-02-24
  - 完成说明：已完成 MD/HTML/PDF 三格式导出与失败重试机制。

- [x] Step 11：补齐观测与稳定性治理
  - 范围：任务耗时、错误码、重试计数、关键指标埋点。
  - 验收：可查看续写采纳率、回滚次数、检查关闭率、导出失败率。
  - 回滚：关闭埋点不影响主流程执行。
  - 完成日期：2026-02-24
  - 完成说明：已完成核心指标埋点、错误监控与稳定性治理能力。

- [x] Step 12：MVP 验收与发布准备
  - 范围：端到端回归、10 万字项目压测、文档与操作手册补齐。
  - 验收：满足 PRD 验收标准（10 轮续写稳定、三格式导出、可回滚、可识别缺章与术语冲突）。
  - 回滚：发布开关可关闭到只读/内测模式。
  - 完成日期：2026-02-25
  - 完成说明：已完成端到端验收、压测验证与发布准备。

---

## 当前建议执行位

所有 MVP Steps 已完成，进入持续优化阶段。

