# Zide 用户手册（当前版本）

> 更新日期：2026-02-25  
> 适用范围：当前仓库实现（Electron + React 桌面端）  
> 适用对象：新用户、普通创作者、运营/测试同学  
> 内容边界：仅覆盖当前 UI 已上线能力 + `window.zide` 已暴露高级能力，不包含 PRD 中待开发功能

## 产品概览

- 产品一句话定位：把长文写作拆成“项目管理 + 章节推进 + AI 辅助 + 检查导出”的可追踪流程。
- 典型用户：
1. 需要长期维护方案/报告/研究稿的内容创作者。
2. 需要验证 AI 写作流程与质量门禁的测试人员。
3. 需要跟踪写作进度与产出的项目负责人。
- 核心使用场景（3 条以内）：
1. 创建项目并生成大纲，按章节持续写作。
2. 使用 AI 进行续写、扩写、重写、补论证、润色、简化。
3. 运行检查并导出 Markdown / HTML / PDF 文件。

## 快速开始

- 使用前准备：
1. 已安装 Node.js（建议 18+）与 npm。
2. 在项目根目录执行过 `npm install`。
3. 本机允许启动 Electron 应用窗口。

- 第一步：启动开发环境
1. 终端 A 执行 `npm run dev:desktop`（启动主进程编译监听 + Vite）。
2. 终端 B 执行 `NODE_ENV=development npm start -w @zide/desktop`（启动 Electron）。
3. 确认打开的是 Zide 首页（项目列表页）。

- 第二步：创建首个项目
1. 点击“+ 新建项目”。
2. 输入项目名称（必填）、你的想法（必填）、类型、目标读者、目标规模、项目描述。
3. 点击“创建”并进入项目工作台。

- 第三步：完成首轮写作
1. 在“项目工作台”点击“生成大纲”。
2. 添加至少一个章节并进入“章节工作台”。
3. 打开章节后输入正文，点击“保存”。
4. 点击任一 AI 按钮（如“续写”）生成内容。

- 首次成功标准（如何确认已完成）：
1. 项目列表里能看到新项目卡片。
2. 章节页面能成功保存内容。
3. AI 操作后正文区内容有变化且无报错弹窗。

## 功能模块说明

### 创建项目

- 适用人群：新用户、项目负责人。
- 价值说明（一句话）：快速建立一个可持续推进的长文项目容器。
- 前置条件：
1. 应用已正常启动。
2. 已准备项目名称和写作想法（核心观点/目标）。
- 操作步骤：
1. 在首页点击“+ 新建项目”。
2. 填写项目表单（至少填写“项目名称”和“你的想法”）并提交。
3. 跳转到项目工作台页面。
- 关键提示：
1. “项目名称”和“你的想法”都不能为空，缺一不可创建。
2. 创建后系统会尝试基于“你的想法”自动生成项目全局设定；即使生成失败，项目仍会创建成功。
- 结果反馈：
1. 成功：自动进入 `/project/:projectId` 页面，顶部显示项目名。
2. 失败：弹窗提示“创建项目失败，请重试”。
- 常见问题：
1. 问：点击创建没反应怎么办？  
   答：先确认“项目名称”和“你的想法”是否都已填写，再查看开发者工具 Console 是否有 IPC 报错。
2. 问：项目创建后看不到？  
   答：返回首页刷新列表；若仍不可见，检查本地运行数据目录是否有对应 `projectId` 文件夹。

### 管理项目列表

- 适用人群：项目负责人、内容运营。
- 价值说明（一句话）：集中查看并管理已有项目，避免项目堆积失控。
- 前置条件：
1. 首页已成功加载项目列表。
- 操作步骤：
1. 在首页项目卡片区域查看已有项目。
2. 点击“设置”进入系统设置页（LLM 配置与 AI 策略）。
3. 点击项目卡片进入对应项目工作台。
4. 点击卡片中的“删除”按钮删除无效项目。
- 关键提示：
1. 删除操作会弹出二次确认。
2. 删除后会移除项目对应运行数据目录，无法直接恢复。
- 结果反馈：
1. 成功：项目卡片从列表中消失。
2. 失败：页面弹出“删除项目失败，请重试”。
- 常见问题：
1. 问：删除后页面没刷新？  
   答：通常是接口超时或刷新失败，手动回到首页后再次确认。
2. 问：删除是不是只删展示，不删文件？  
   答：当前实现会同步删除项目目录，不是“软删除”。

### 生成并确认大纲

- 适用人群：内容策划者、主笔。
- 价值说明（一句话）：把写作任务拆成章节结构，降低跑题风险。
- 前置条件：
1. 已进入项目工作台。
2. 项目已存在有效 `projectId`。
- 操作步骤：
1. 在“大纲管理”页点击“生成大纲”。
2. 按需点击“添加章节”补充章节。
3. 确认结构无误后点击“确认大纲”。
- 关键提示：
1. 当前页面展示章节标题、编号、目标和状态。
2. “生成大纲”后按钮会进入已生成状态。
- 结果反馈：
1. 成功：大纲列表展示章节项，状态可见。
2. 失败：页面弹出 API 错误信息。
- 常见问题：
1. 问：为什么生成后章节还是少？  
   答：当前可继续用“添加章节”补充，不需要重建整个项目。
2. 问：为什么章节状态一直是待开始？  
   答：章节状态会在写作/编辑过程中更新，单纯生成大纲不会自动置为完成。

### 编辑项目全局设定

- 适用人群：希望统一文稿方向与风格的主笔/项目负责人。
- 价值说明（一句话）：把项目背景、目标、约束和文风集中管理，降低后续章节跑偏风险。
- 前置条件：
1. 已进入项目工作台。
2. 当前项目已可正常读取。
- 操作步骤：
1. 在项目页顶部点击“全局设定”。
2. 填写或修改“背景设定 / 目标 / 约束条件 / 风格”。
3. 点击“保存设定”。
- 关键提示：
1. 新建项目时填写“你的想法”后，系统会尝试自动生成一版全局设定，可在这里二次编辑。
2. 当前保存的是项目级配置，会影响后续大纲与 AI 生成上下文。
- 结果反馈：
1. 成功：页面提示“设定已保存”。
2. 失败：保存后未生效或出现错误提示。
- 常见问题：
1. 问：全局设定改完后，旧章节会自动重写吗？  
   答：不会自动改写旧正文，仅影响后续生成和你后续手动编辑。
2. 问：不填全局设定能继续写吗？  
   答：可以，系统允许空设定运行。

### 编辑章节

- 适用人群：日常写作者、编辑。
- 价值说明（一句话）：在单章维度持续写作并管理完成度。
- 前置条件：
1. 大纲中已存在章节。
2. 已从工作台进入具体章节编辑页。
- 操作步骤：
1. 在左侧章节列表选择目标章节。
2. 在正文编辑区输入或修改内容。
3. 点击“保存”。
- 关键提示：
1. 页面会显示当前章节字数与完成度。
2. 编辑区保存前离开页面，未保存内容不会自动持久化。
- 结果反馈：
1. 成功：保存按钮恢复可点状态，刷新后内容仍存在。
2. 失败：API 异常提示。
- 常见问题：
1. 问：保存后字数没变化？  
   答：确认是否保存的是当前章节；切换章节再返回可验证是否落盘。
2. 问：章节打不开？  
   答：通常是章节文件不存在或 ID 不一致，先回到工作台重新选择章节。

### 使用 AI 辅助写作

- 适用人群：需要加速初稿/改稿的创作者。
- 价值说明（一句话）：在章节内快速完成生成、扩写与改写。
- 前置条件：
1. 章节页已打开。
2. 当前章节至少有基础上下文内容。
- 操作步骤：
1. 在章节工具栏选择意图：`续写 / 扩写 / 重写 / 补论证 / 润色 / 简化`。
2. 等待“AI生成中...”状态结束。
3. 预览结果后点击“保存”。
- 关键提示：
1. 若未配置可用 API Key，系统通常使用 mock 或不可用配置，输出质量可能不稳定。
2. `重写 / 润色 / 简化` 属于改写型操作，建议先手动创建快照。
- 结果反馈：
1. 成功：正文内容更新，章节操作计数增加。
2. 失败：出现“AI 生成失败，请重试”提示。
- 常见问题：
1. 问：为什么输出风格很模板化？  
   答：通常是未正确配置真实模型连接，系统回退到 mock 或低质量配置；可在“设置”里检查 LLM 参数。
2. 问：AI 生成后内容不满意怎么办？  
   答：建议先创建章节快照，再更换意图重试，避免直接覆盖有效版本。

### 查看 AI 历史并采纳结果（高级）

- 适用人群：需要对比多个 AI 版本的编辑者。
- 价值说明（一句话）：查看同一章节的历史生成记录并标记采纳结果。
- 前置条件：
1. 章节已经执行过 AI 操作。
2. 已打开开发者工具 Console。
- 操作步骤：
1. 获取历史记录：  
   `await window.zide.getOperationHistory(projectId, chapterId)`
2. 选择目标记录后执行采纳：  
   `await window.zide.adoptOperation(projectId, chapterId, operationId)`
- 关键提示：
1. 历史记录包含 `intent`、`tokens`、`model`、`createdAt` 等字段。
2. “采纳”是记录状态标记，不会自动替换当前正文。
- 结果反馈：
1. 成功：接口返回 `success: true`。
2. 失败：返回错误信息（通常为操作 ID 不存在或章节路径异常）。
- 常见问题：
1. 问：为什么采纳后正文没变化？  
   答：采纳只更新操作状态，不会写回正文内容。
2. 问：查不到历史记录？  
   答：先确认该章节是否触发过 AI 生成，且章节 ID 与文件名一致。

### 配置 LLM 与 AI 策略

- 适用人群：需要提升 AI 质量与稳定性的用户、测试同学。
- 价值说明（一句话）：通过设置模型连接参数和策略，控制 AI 的生成效果与成本。
- 前置条件：
1. 已获取模型供应商 API Key（若用真实模型）。
2. 能从首页进入“设置”页面。
- 操作步骤：
1. 首页点击“设置”进入设置页。
2. 在“LLM 配置”中选择提供商，填写模型名称、API Key、API 地址、Temperature、最大 Token 数。
3. 点击“测试连接”，确认连通。
4. 点击“保存设置”。
5. 在“AI 策略管理”里选择策略（也可在项目工作台顶部下拉切换）。
- 关键提示：
1. 提供商下拉支持 `openai / anthropic / minimax / kimi / azure / custom`。
2. 切换策略后会立即生效于后续 AI 生成，不会追溯修改历史内容。
3. 保存的配置会写入本地用户目录，下次启动会自动加载。
- 结果反馈：
1. 成功：页面提示“设置已保存”或“AI策略已切换”。
2. 失败：显示“保存设置失败，请重试”或“连接失败”。
- 常见问题：
1. 问：测试连接失败怎么办？  
   答：先检查 API Key、模型名、API 地址，再检查网络代理与供应商配额。
2. 问：为什么项目页和设置页都能改 AI 策略？  
   答：两处都是同一全局策略入口，任一处修改都会即时生效。

### 创建快照与版本保护

- 适用人群：高频改稿用户。
- 价值说明（一句话）：在关键改写前留存可追溯版本。
- 前置条件：
1. 已打开章节页面。
2. 当前章节已有可回溯内容。
- 操作步骤：
1. 在章节页点击“📷 创建快照”。
2. 继续执行 AI 改写或人工修改。
3. 如需回滚，可通过控制台调用：  
   `await window.zide.rollbackSnapshot(snapshotId)` 或 `await window.zide.rollbackChapter(projectId, chapterId)`
- 关键提示：
1. 快照创建后会写入项目目录的 `snapshots/` 下。
2. 回滚会直接覆盖章节文件，建议先保留当前正文副本。
- 结果反馈：
1. 成功：页面提示“快照创建成功”。
2. 回滚失败：返回错误消息，通常与快照 ID 无效或文件路径异常有关。
- 常见问题：
1. 问：为什么创建成功却回滚失败？  
   答：先确认使用的是有效 `snapshotId`，并检查目标项目目录是否完整。
2. 问：那怎么降低风险？  
   答：关键改写前建议额外复制章节正文到本地临时文件做双保险。

### 查看项目统计

- 适用人群：项目负责人、运营同学。
- 价值说明（一句话）：快速了解章节进度和 AI 产出情况。
- 前置条件：
1. 项目已有章节和操作数据。
2. 在项目工作台切到“项目统计”标签。
- 操作步骤：
1. 进入项目后点击“项目统计”标签。
2. 查看总章节、已完成章节、总字数、AI 操作次数、采纳率。
- 关键提示：
1. 统计来自本地日志与章节文件汇总。
2. 采纳率依赖操作日志中的采纳标记，若历史日志缺失会偏低。
- 结果反馈：
1. 成功：显示卡片指标数据。
2. 失败：无数据显示并伴随错误提示。
- 常见问题：
1. 问：采纳率为什么总是很低？  
   答：采纳率依赖操作日志元数据，未完整记录时会偏低。
2. 问：为什么我明明写了很多字，但总字数为 0？  
   答：通常是章节正文没有成功保存，或章节文件结构异常导致统计失败。

### 维护上下文索引（高级）

- 适用人群：需要提高生成稳定性的高级用户。
- 价值说明（一句话）：手动维护上下文索引，提升检索与上下文打包质量。
- 前置条件：
1. 项目已有章节内容。
2. 已打开开发者工具 Console。
- 操作步骤：
1. 索引章节：  
   `await window.zide.indexChapter(projectId, chapterId, content)`
2. 检索上下文：  
   `await window.zide.retrieveContext(projectId, chapterId, '关键词', 5)`
3. 获取上下文包：  
   `await window.zide.packContext(projectId, chapterId)`
4. 查看索引统计：  
   `await window.zide.getIndexStats(projectId)`
5. 重建或清空索引：  
   `await window.zide.rebuildIndex(projectId)`  
   `await window.zide.clearIndex(projectId)`
- 关键提示：
1. 章节正文为空时，索引与检索结果可能为空。
2. `clearIndex` 是清空操作，建议先导出或备份关键内容。
- 结果反馈：
1. 成功：返回 `success: true` 或统计结果对象。
2. 失败：返回索引路径或章节参数相关错误。
- 常见问题：
1. 问：为什么检索结果总是空？  
   答：通常是未先索引、关键词不匹配或章节内容过短。
2. 问：重建索引后还是不稳定？  
   答：先确认章节文件结构是否完整，再检查 `chapterId` 与章节文件名是否一致。

### 运行质量检查

- 适用人群：交付前质检、测试人员。
- 价值说明（一句话）：在导出前发现结构与内容风险。
- 前置条件：
1. 项目至少已有部分章节内容。
2. 已进入项目工作台。
- 操作步骤：
1. 在项目工作台切换到“整体检查”标签。
2. 点击“运行检查”。
3. 在结果列表中按需点击“修复”或“忽略”。
4. 需要更细粒度检查时，可在 Console 调用分项接口（如 `checkTermConsistency`）。
- 关键提示：
1. 当前 `checkOutlineDrift` 仍为占位能力，返回空列表是正常现象。
2. “修复/忽略”按钮目前不会持久化状态，再次运行检查可能出现相同问题项。
- 结果反馈：
1. 成功：页面展示问题清单（缺章/重复内容/完成度低等）。
2. 失败：控制台输出错误或无结果刷新。
- 常见问题：
1. 问：为什么全量检查看不到术语冲突？  
   答：术语一致性是独立接口，需单独调用。
2. 问：重复检测误报怎么办？  
   答：先人工确认，再根据章节目标调整内容边界。

### 导出交付文件

- 适用人群：交付负责人、运营同学。
- 价值说明（一句话）：将章节合并为可交付文件。
- 前置条件：
1. 项目内容已达到可交付状态。
2. 已进入项目工作台。
- 操作步骤：
1. 在项目工作台切换到“导出中心”标签。
2. 选择导出格式（`Markdown / HTML / PDF`）。
3. 点击“导出项目”生成文件。
4. 点击“预览”查看内容片段，点击“打开目录”直达输出目录。
- 关键提示：
1. 输出目录在 Electron 用户数据目录下的 `projects/<projectId>/output/`。
2. 当前 `pdf` 为兼容输出（HTML 内容写入 `.pdf` 文件），不是完整排版引擎生成的 PDF。
- 结果反馈：
1. 成功：页面提示“导出成功”，并在“导出历史”显示最新记录。
2. 失败：页面提示“导出失败，请重试”。
- 常见问题：
1. 问：为什么 `final.pdf` 在某些阅读器里显示异常？  
   答：当前实现并非真实 PDF 渲染，建议优先使用 `final.html` 或 `final.md`。
2. 问：导出内容混入元数据怎么办？  
   答：导出前先检查章节文件结构，避免 frontmatter 残留到正文。

## 常见问题（FAQ）

### 为什么我在项目页切不到“整体检查/导出中心”？

- 症状：进入项目后只看到部分标签，或标签区域显示不完整。
- 原因：窗口宽度过小、样式加载异常，或当前不在项目工作台页面。
- 解决步骤：
1. 先确认当前 URL 是 `#/project/:projectId`。
2. 拉宽窗口或重启应用后重试。
3. 临时可直达 `#/project/<projectId>/check` 与 `#/project/<projectId>/export`。

### AI 生成为什么有时特别慢？

- 症状：点击 AI 按钮后长时间“AI生成中...”。
- 原因：真实模型链路受网络、供应商限流、模型负载影响。
- 解决步骤：
1. 用 `aiPing` 检查连通性。
2. 降低模型负载（如切换轻量模型）。
3. 失败时重试并保留错误日志。

### 项目统计为什么和体感不一致？

- 症状：字数、采纳率偏低。
- 原因：统计依赖日志与字段口径，当前存在已知偏差。
- 解决步骤：
1. 先以章节页展示数据为准。
2. 导出前再做人工复核。
3. 将异常案例提交给研发用于口径修正。

### 快照回滚失败后如何恢复？

- 症状：`rollbackSnapshot` 或 `rollbackChapter` 调用失败。
- 原因：常见为快照 ID 不存在、项目目录异常、章节文件已被外部修改。
- 解决步骤：
1. 先保留当前章节副本。
2. 用 `window.zide.getSnapshots(projectId)` 重新确认可用快照 ID。
3. 从手工备份或历史导出内容恢复，再重新建立快照链路。

## 故障排查

按“先易后难”顺序执行：

1. 账号与权限检查  
   当前版本为本地单用户模式，无注册/登录/权限体系，此项可跳过。

2. 网络与设备检查  
   若使用真实 LLM，先检查网络、代理和 API 服务状态；若使用 mock，此项影响较小。

3. 页面状态与缓存检查  
   重启双终端进程（`npm run dev:desktop` + `NODE_ENV=development npm start -w @zide/desktop`），再重新进入页面。

4. 数据一致性检查  
   检查项目目录下 `meta/`、`outline/`、`chapters/`、`snapshots/`、`output/` 是否完整，确认 `chapterId` 与章节文件名一致。

5. 联系支持前最小必要信息  
   请准备：项目 ID、操作步骤、请求参数、完整报错、发生时间（例如 2026-02-25 12:30）、相关日志片段。

## 术语表

- 项目（Project）：一次长文生产任务的管理单元。
- 大纲（Outline）：章节结构与章节目标的集合。
- 章节（Chapter）：可独立编辑和生成的正文单元。
- AI 意图（Intent）：单次 AI 生成的目标动作，如续写、扩写、重写等。
- 上下文包（Context Pack）：生成前注入的项目背景、章节片段、术语和大纲信息。
- 快照（Snapshot）：特定时刻保存的章节或全局版本副本。
- 检查问题（Check Issue）：质检后发现的待处理风险项。
- 导出任务（Export Job）：把项目内容产出为目标格式文件的一次执行。
- 操作日志（Operation Log）：记录操作类型、状态、耗时和错误信息的结构化日志。
