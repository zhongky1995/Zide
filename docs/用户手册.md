# Zide 用户手册（当前版本）

> 更新日期：2026-02-25  
> 适用范围：当前仓库实现（Electron + React 桌面端）  
> 适用对象：新用户、普通创作者、运营/测试同学

## 产品概览

- 产品一句话定位：把长文写作拆成“项目管理 + 章节推进 + AI 辅助 + 检查导出”的可追踪流程。
- 典型用户：
1. 需要长期维护方案/报告/研究稿的内容创作者。
2. 需要验证 AI 写作流程与质量门禁的测试人员。
3. 需要跟踪写作进度与产出的项目负责人。
- 核心使用场景（3 条以内）：
1. 创建项目并生成大纲，按章节持续写作。
2. 使用 AI 进行续写、扩写、重写、补论证、润色、简化。
3. 运行检查并导出 Markdown / HTML / PDF 文件。

## 快速开始

- 使用前准备：
1. 已安装 Node.js（建议 18+）与 npm。
2. 在项目根目录执行过 `npm install`。
3. 本机允许启动 Electron 应用窗口。

- 第一步：启动开发环境
1. 终端 A 执行 `npm run dev:desktop`（启动主进程编译监听 + Vite）。
2. 终端 B 执行 `NODE_ENV=development npm start -w @zide/desktop`（启动 Electron）。
3. 确认打开的是 Zide 首页（项目列表页）。

- 第二步：创建首个项目
1. 点击“+ 新建项目”。
2. 输入项目名称（必填）、类型、目标读者、目标规模、项目描述。
3. 点击“创建”并进入项目工作台。

- 第三步：完成首轮写作
1. 在“项目工作台”点击“生成大纲”。
2. 添加至少一个章节并进入“章节工作台”。
3. 打开章节后输入正文，点击“保存”。
4. 点击任一 AI 按钮（如“续写”）生成内容。

- 首次成功标准（如何确认已完成）：
1. 项目列表里能看到新项目卡片。
2. 章节页面能成功保存内容。
3. AI 操作后正文区内容有变化且无报错弹窗。

## 功能模块说明

### 创建项目

- 适用人群：新用户、项目负责人。
- 价值说明（一句话）：快速建立一个可持续推进的长文项目容器。
- 前置条件：
1. 应用已正常启动。
2. 已准备项目名称与项目类型。
- 操作步骤：
1. 在首页点击“+ 新建项目”。
2. 填写项目表单并提交。
3. 跳转到项目工作台页面。
- 关键提示：
1. 项目名称不能为空。
2. 类型建议按真实文稿类型选择（方案/报告/研究报告/小说/其他）。
- 结果反馈：
1. 成功：自动进入 `/project/:projectId` 页面，顶部显示项目名。
2. 失败：弹窗提示“创建项目失败，请重试”。
- 常见问题：
1. 问：点击创建没反应怎么办？  
   答：先确认“项目名称”是否为空，再查看开发者工具 Console 是否有 IPC 报错。
2. 问：项目创建后看不到？  
   答：返回首页刷新列表；若仍不可见，检查本地运行数据目录是否有对应 `projectId` 文件夹。

### 生成并确认大纲

- 适用人群：内容策划者、主笔。
- 价值说明（一句话）：把写作任务拆成章节结构，降低跑题风险。
- 前置条件：
1. 已进入项目工作台。
2. 项目已存在有效 `projectId`。
- 操作步骤：
1. 在“大纲管理”页点击“生成大纲”。
2. 按需点击“添加章节”补充章节。
3. 确认结构无误后点击“确认大纲”。
- 关键提示：
1. 当前页面展示章节标题、编号、目标和状态。
2. “生成大纲”后按钮会进入已生成状态。
- 结果反馈：
1. 成功：大纲列表展示章节项，状态可见。
2. 失败：页面弹出 API 错误信息。
- 常见问题：
1. 问：为什么生成后章节还是少？  
   答：当前可继续用“添加章节”补充，不需要重建整个项目。
2. 问：为什么章节状态一直是待开始？  
   答：章节状态会在写作/编辑过程中更新，单纯生成大纲不会自动置为完成。

### 编辑章节

- 适用人群：日常写作者、编辑。
- 价值说明（一句话）：在单章维度持续写作并管理完成度。
- 前置条件：
1. 大纲中已存在章节。
2. 已从工作台进入具体章节编辑页。
- 操作步骤：
1. 在左侧章节列表选择目标章节。
2. 在正文编辑区输入或修改内容。
3. 点击“保存”。
- 关键提示：
1. 页面会显示当前章节字数与完成度。
2. 编辑区保存前离开页面，未保存内容不会自动持久化。
- 结果反馈：
1. 成功：保存按钮恢复可点状态，刷新后内容仍存在。
2. 失败：API 异常提示。
- 常见问题：
1. 问：保存后字数没变化？  
   答：确认是否保存的是当前章节；切换章节再返回可验证是否落盘。
2. 问：章节打不开？  
   答：通常是章节文件不存在或 ID 不一致，先回到工作台重新选择章节。

### 使用 AI 辅助写作

- 适用人群：需要加速初稿/改稿的创作者。
- 价值说明（一句话）：在章节内快速完成生成、扩写与改写。
- 前置条件：
1. 章节页已打开。
2. 当前章节至少有基础上下文内容。
- 操作步骤：
1. 在章节工具栏选择意图：`续写 / 扩写 / 重写 / 补论证 / 润色 / 简化`。
2. 等待“AI生成中...”状态结束。
3. 预览结果后点击“保存”。
- 关键提示：
1. 默认使用 `MockLLMAdapter`，输出用于链路验证，不代表线上真实模型质量。
2. `重写 / 润色 / 简化` 属于改写型操作，建议先手动创建快照。
- 结果反馈：
1. 成功：正文内容更新，章节操作计数增加。
2. 失败：出现“AI 生成失败，请重试”提示。
- 常见问题：
1. 问：为什么输出风格很模板化？  
   答：当前默认是 Mock 适配器；可切换真实 LLM（见下一模块）。
2. 问：AI 生成后内容不满意怎么办？  
   答：建议先创建章节快照，再更换意图重试，避免直接覆盖有效版本。

### 配置真实 LLM（高级）

- 适用人群：研发、测试、对接模型服务的高级用户。
- 价值说明（一句话）：将 AI 生成从 mock 切换为真实模型供应商。
- 前置条件：
1. 已获取模型供应商 API Key。
2. 已打开开发者工具 Console。
- 操作步骤：
1. 切换到真实适配器：  
   `await window.zide.aiSwitchAdapter(true)`
2. 更新配置（示例 OpenAI）：  
   `await window.zide.aiUpdateConfig({ provider: 'openai', model: 'gpt-4o-mini', apiKey: '你的密钥' })`
3. 检查连通性：  
   `await window.zide.aiPing()`
4. 查看生效配置：  
   `await window.zide.aiGetConfig()`
- 关键提示：
1. 真实模型建议使用的 provider：`openai`、`anthropic`、`minimax`、`kimi`（`custom` 主要用于 mock/自定义适配场景）。
2. `aiGetConfig` 返回时会掩码 API Key（只显示后 4 位）。
3. 网络/账单/模型名错误都会导致 `aiPing` 或生成失败。
- 结果反馈：
1. 成功：`aiPing` 返回 `success: true` 且 `data: true`。
2. 失败：返回具体错误信息（如认证失败、模型不可用、网络错误）。
- 常见问题：
1. 问：配置后仍走 mock，为什么？  
   答：确认 `aiSwitchAdapter(true)` 是否成功，以及 `provider` 是否是受支持值。
2. 问：`aiPing` 失败但没明确原因？  
   答：优先检查 API Key、baseUrl、模型名，再检查本机网络代理设置。

### 创建快照与版本保护

- 适用人群：高频改稿用户。
- 价值说明（一句话）：在关键改写前留存可追溯版本。
- 前置条件：
1. 已打开章节页面。
2. 当前章节已有可回溯内容。
- 操作步骤：
1. 在章节页点击“📷 创建快照”。
2. 继续执行 AI 改写或人工修改。
3. 如需回滚，可通过控制台调用：  
   `await window.zide.rollbackSnapshot(snapshotId)` 或 `await window.zide.rollbackChapter(projectId, chapterId)`
- 关键提示：
1. 快照创建功能可用。
2. 当前版本“按快照 ID 回滚”存在已知问题，可能返回 `Snapshot not found`。
- 结果反馈：
1. 成功：页面提示“快照创建成功”。
2. 回滚失败：返回错误消息，需按手工方式恢复。
- 常见问题：
1. 问：为什么创建成功却回滚失败？  
   答：当前快照反查逻辑仍有缺陷，属于已知问题。
2. 问：那怎么降低风险？  
   答：关键改写前建议额外复制章节正文到本地临时文件做双保险。

### 查看项目统计

- 适用人群：项目负责人、运营同学。
- 价值说明（一句话）：快速了解章节进度和 AI 产出情况。
- 前置条件：
1. 项目已有章节和操作数据。
2. 在项目工作台切到“项目统计”标签。
- 操作步骤：
1. 进入项目后点击“项目统计”标签。
2. 查看总章节、已完成章节、总字数、AI 操作次数、采纳率。
- 关键提示：
1. 统计来自本地日志与章节文件汇总。
2. 当前 `totalWords` 指标可能出现偏低或 0 的情况（已知问题）。
- 结果反馈：
1. 成功：显示卡片指标数据。
2. 失败：无数据显示并伴随错误提示。
- 常见问题：
1. 问：采纳率为什么总是很低？  
   答：采纳率依赖操作日志元数据，未完整记录时会偏低。
2. 问：为什么我明明写了很多字，但总字数为 0？  
   答：当前字数统计口径与章节文件字段存在偏差，属于已知问题。

### 运行质量检查（高级）

- 适用人群：交付前质检、测试人员。
- 价值说明（一句话）：在导出前发现结构与内容风险。
- 前置条件：
1. 项目至少已有部分章节内容。
2. 已打开开发者工具 Console。
- 操作步骤：
1. 执行全量检查：  
   `await window.zide.runCheck(projectId)`
2. 执行分项检查：  
   `await window.zide.checkMissingChapters(projectId)`  
   `await window.zide.checkDuplicateContent(projectId)`  
   `await window.zide.checkCompletion(projectId, 30)`  
   `await window.zide.checkTermConsistency(projectId)`
3. 按结果处理问题项。
- 关键提示：
1. 当前 `checkOutlineDrift` 仍为占位能力，返回空列表是正常现象。
2. 问题状态标记后是否持久化，取决于后端实现版本。
- 结果反馈：
1. 成功：返回结构化问题数组（含类型、严重级别、建议）。
2. 失败：返回 `success: false` 与错误说明。
- 常见问题：
1. 问：为什么全量检查看不到术语冲突？  
   答：术语一致性是独立接口，需单独调用。
2. 问：重复检测误报怎么办？  
   答：先人工确认，再根据章节目标调整内容边界。

### 导出交付文件（高级）

- 适用人群：交付负责人、运营同学。
- 价值说明（一句话）：将章节合并为可交付文件。
- 前置条件：
1. 项目内容已达到可交付状态。
2. 已打开开发者工具 Console。
- 操作步骤：
1. 导出整项目：  
   `await window.zide.exportProject(projectId, 'md')`  
   `await window.zide.exportProject(projectId, 'html')`  
   `await window.zide.exportProject(projectId, 'pdf')`
2. 查询导出历史：  
   `await window.zide.getExportHistory(projectId)`
3. 如需清理，调用：  
   `await window.zide.deleteExport(filePath)`
- 关键提示：
1. 输出目录在 Electron 用户数据目录下的 `projects/<projectId>/output/`。
2. 当前 `pdf` 为兼容输出（HTML 内容写入 `.pdf` 文件），不是完整排版引擎生成的 PDF。
- 结果反馈：
1. 成功：返回 `filePath`、`chapterCount`、`wordCount`、`createdAt`。
2. 失败：返回导出错误信息。
- 常见问题：
1. 问：为什么 `final.pdf` 在某些阅读器里显示异常？  
   答：当前实现并非真实 PDF 渲染，建议优先使用 `final.html` 或 `final.md`。
2. 问：导出内容混入元数据怎么办？  
   答：导出前先检查章节文件结构，避免 frontmatter 残留到正文。

## 常见问题（FAQ）

### 为什么我能看到界面，但部分功能还需要在 Console 调用？

- 症状：项目/章节有 UI，检查和导出在 UI 中入口不完整。
- 原因：当前版本采用“核心流程先 UI 化，部分能力先保留 API 入口”的迭代策略。
- 解决步骤：
1. 日常写作走页面操作。
2. 检查、导出、LLM 高级配置走 `window.zide`。
3. 关键操作前先创建快照。

### AI 生成为什么有时特别慢？

- 症状：点击 AI 按钮后长时间“AI生成中...”。
- 原因：真实模型链路受网络、供应商限流、模型负载影响。
- 解决步骤：
1. 用 `aiPing` 检查连通性。
2. 降低模型负载（如切换轻量模型）。
3. 失败时重试并保留错误日志。

### 项目统计为什么和体感不一致？

- 症状：字数、采纳率偏低。
- 原因：统计依赖日志与字段口径，当前存在已知偏差。
- 解决步骤：
1. 先以章节页展示数据为准。
2. 导出前再做人工复核。
3. 将异常案例提交给研发用于口径修正。

### 快照回滚失败后如何恢复？

- 症状：`rollbackSnapshot` 返回 `Snapshot not found`。
- 原因：快照 ID 反查路径存在缺陷。
- 解决步骤：
1. 先保留当前章节副本。
2. 从手工备份或历史导出内容恢复。
3. 临时避免依赖“按 ID 回滚”作为唯一恢复方式。

## 故障排查

按“先易后难”顺序执行：

1. 账号与权限检查  
   当前版本为本地单用户模式，无注册/登录/权限体系，此项可跳过。

2. 网络与设备检查  
   若使用真实 LLM，先检查网络、代理和 API 服务状态；若使用 mock，此项影响较小。

3. 页面状态与缓存检查  
   重启双终端进程（`npm run dev:desktop` + `NODE_ENV=development npm start -w @zide/desktop`），再重新进入页面。

4. 数据一致性检查  
   检查项目目录下 `meta/`、`outline/`、`chapters/`、`snapshots/`、`output/` 是否完整，确认 `chapterId` 与章节文件名一致。

5. 联系支持前最小必要信息  
   请准备：项目 ID、操作步骤、请求参数、完整报错、发生时间（例如 2026-02-25 12:30）、相关日志片段。

## 术语表

- 项目（Project）：一次长文生产任务的管理单元。
- 大纲（Outline）：章节结构与章节目标的集合。
- 章节（Chapter）：可独立编辑和生成的正文单元。
- AI 意图（Intent）：单次 AI 生成的目标动作，如续写、扩写、重写等。
- 上下文包（Context Pack）：生成前注入的项目背景、章节片段、术语和大纲信息。
- 快照（Snapshot）：特定时刻保存的章节或全局版本副本。
- 检查问题（Check Issue）：质检后发现的待处理风险项。
- 导出任务（Export Job）：把项目内容产出为目标格式文件的一次执行。
- 操作日志（Operation Log）：记录操作类型、状态、耗时和错误信息的结构化日志。
