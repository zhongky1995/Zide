# PRD｜Zide 长文 AI 生产系统

版本：v2.1（产品版 + 实现状态）
日期：2026-02-25
状态：Active
文档类型：产品需求文档（PRD）

---

## 产品版本与实现状态

| 版本 | 状态 | 实现进度 |
|------|------|----------|
| V1.0 MVP | 已完成 | 100% - 12个Step全部完成 |
| V1.1 用户引导版 | 待开发 | P1 功能 |
| V1.2 模板配置版 | 待开发 | P1 功能 |
| V2.0 增强版 | 规划中 | P2 功能 |

---

## 1. 产品机会与目标

### 1.1 背景与机会

高频长文创作者（方案、报告、标书、小说）在使用通用 AI 时，核心瓶颈不是“不会写”，而是“无法稳定完成超长内容生产”：

1. 单轮输出长度受限，无法一次成稿。
2. 多轮续写容易跑题，结构一致性逐步下降。
3. 中途改动后，前后章节难以同步更新。
4. 缺少可见进度与缺口提示，无法像项目一样推进。
5. 导出交付需要手工合并、校对、格式整理。

### 1.2 用户价值一句话

把“长文写作”转化为“可回滚、可检查、可交付的项目化生产流程”。

### 1.3 业务目标一句话

提供一个 AI 驱动的长文生产工作台，让用户以章节化、流程化方式稳定产出可交付长文并一键导出。

### 1.4 本期不做范围（明确边界）

1. 不做通用知识库产品（仅服务当前项目上下文）。
2. 不做多人实时协同编辑。
3. 不做复杂排版引擎（仅提供可用级 Markdown 渲染与导出）。
4. 不做开放插件市场与第三方生态。

### 1.5 关键假设（信息缺失下的推进假设）

1. 首版以单用户桌面/本地工程形态为主。
2. AI 模型调用能力由上层统一封装，PRD 聚焦产品层能力而非特定厂商 API。
3. 用户可接受“模板化流程 + 可编辑自由度”的平衡，不追求完全自由写作界面。
4. 导出质量以“方案/报告可直接交付”为目标，不覆盖专业出版级排版。

---

## 2. 用户与场景

### 2.1 目标用户分层

1. P0 用户：咨询/售前/产品/运营从业者，高频产出项目方案、汇报材料、研究报告。
2. P1 用户：科研与内容团队，需要章节化长文协作与审查（单用户模式先满足）。
3. P2 用户：小说与长篇创作者，关注世界观一致性与长线剧情控制。

### 2.2 核心使用场景

1. 从 0 到 1 新建长文项目，快速得到章节骨架。
2. 按章节推进，借助 AI 多轮续写与改写，保持全局一致性。
3. 中期执行整稿体检，定位缺章、重复、术语冲突并修复。
4. 终期一键导出 PDF / Markdown / HTML 交付版本。

### 2.3 现有替代方案与痛点

1. 通用对话式 AI：上下文窗口短、轮次越多越偏题。
2. 传统文档编辑器：有排版能力但无上下文自动组装与项目级检查。
3. 手工分文件管理：可控但高成本，难以自动化校验与导出。

---

## 3. 需求结构与优先级

### 3.1 需求清单（P0 / P1 / P2）

#### P0（MVP 必须）- 已实现 ✅

1. 项目创建向导：文档类型、目标读者、目标规模。✅
2. 项目底座表单：背景、目标、限制、术语、风格约束。✅
3. 大纲生成与编辑：章节增删改、顺序调整、章节目标定义。✅
4. 章节工作台：Markdown 编辑、章节状态、AI 意图按钮（续写/扩写/重写/补论证）。✅
5. 上下文引擎：索引 -> 检索 -> 打包，支持分段续写与上下文拼接。✅
6. 章节摘要与完成度自动更新。✅
7. 整体检查：缺失章节、术语不统一、重复内容、逻辑冲突检测。✅
8. 快照与回滚：按章节和全局版本回退。✅
9. 导出中心：合并章节并导出 PDF / Markdown / HTML 到统一输出目录。✅

#### P1（增强版）- 待实现

1. 附件/资料导入（链接、文档）并参与检索。
2. 术语库与风格规则的自定义模板化复用。
3. 章节间引用追踪与”被影响章节提示”。
4. 多模型策略（不同任务选择不同模型）。
5. **用户引导流程**：首次使用引导、新手教程、操作提示气泡。
6. **项目设置页面**：项目信息编辑、底座参数调整、删除项目。
7. **章节模板**：预定义章节结构模板、快速应用模板。
8. **AI 设置配置界面**：模型选择、温度参数、最大token、生成速度。
9. **快捷键支持**：常用操作键盘快捷键、自定义快捷键。
10. **主题切换**：亮色/暗色/跟随系统主题。
11. **数据备份导出**：项目数据完整备份导入。

#### P2（扩展版）- 规划中

1. 多人协作与角色权限。
2. 审批流与评审批注闭环。
3. 插件化能力与自定义导出模板。

### 3.2 优先级依据（价值 / 成本 / 风险）

1. 用户价值优先：是否直接提升“稳定完成长文”的成功率。
2. 成本可控：首版避免高耦合复杂能力（协同、插件）。
3. 风险可控：优先建设回滚、检查、可观测日志，降低 AI 不确定性风险。

### 3.3 MVP 范围

1. 单项目单人模式完整闭环：创建 -> 章节推进 -> 体检 -> 导出。
2. 能支持 10 万字量级内容管理与分段生成。
3. 支持连续多轮续写并提供回滚保障。

### 3.4 非 MVP 范围

1. 实时协同编辑。
2. 复杂审阅工作流。
3. 行业专有模板市场。

---

## 4. 产品架构设计

### 4.1 功能架构（模块职责与依赖）

1. 项目初始化模块：创建工程、生成目录、初始化元数据。✅
2. 结构规划模块：生成并维护大纲、章节目标、章节状态。✅
3. 写作执行模块：章节编辑、AI 指令触发、生成内容落盘。✅
4. 上下文引擎模块：内容切片、索引、检索、打包、提示词装配。✅
5. 质量校验模块：结构完整性、术语一致性、逻辑冲突检测。✅
6. 版本控制模块：快照记录、比对、回滚。✅
7. 导出模块：章节合并、目录生成、格式转换、输出管理。✅

### 4.1.1 当前实现状态

| 模块 | 实现状态 | UI 入口 | 备注 |
|------|----------|---------|------|
| 项目初始化 | 已完成 | / | 创建项目弹窗 |
| 大纲管理 | 已完成 | 项目页-Tab | 模板选择、大纲生成/编辑 |
| 章节工作台 | 已完成 | 项目页-Tab + 章节页 | 6种AI意图 |
| 项目统计 | 已完成 | 项目页-Tab | 总章节/字数/AI操作/采纳率 |
| 整体检查 | 已完成 | 项目页-Tab | 缺章/术语冲突/重复检测 |
| 导出中心 | 已完成 | 项目页-Tab | MD/HTML/PDF |
| AI设置 | 已完成 | /settings | 提供商/模型/参数配置 |

### 4.2 信息架构（导航、页面、对象关系）

#### 页面路由（当前实现）

| 路由 | 页面 | 状态 |
|------|------|------|
| `/` | 项目列表页 | 已实现 |
| `/settings` | AI 设置页 | 已实现 |
| `/project/:projectId` | 项目工作台 | 已实现 |
| `/project/:projectId/chapter/:chapterId` | 章节编辑器 | 已实现 |

#### 主导航（规划中）

1. 项目首页（进度、章节总览、近期事件）
2. 项目底座（背景/目标/限制/术语/风格）
3. 大纲中心（章节结构与目标）
4. 章节工作台（正文编辑 + AI 操作 + 章节状态）
5. 整体检查（问题清单与修复入口）
6. 导出中心（格式选择、导出记录、输出目录）
7. 项目设置（项目配置、参数调整）
8. AI 设置（模型配置、参数调优）
9. 用户引导（新手教程、操作指引）

#### 4.2.1 项目工作台 Tab 结构（当前实现）

```
项目工作台
├── 大纲管理 Tab
│   ├── 生成大纲按钮（模板选择弹窗）
│   ├── 确认大纲按钮
│   ├── 添加章节按钮
│   └── 章节列表（状态/目标/删除）
├── 章节工作台 Tab
│   ├── 侧边栏：章节列表
│   └── 主区域：待选择章节提示
├── 项目统计 Tab
│   ├── 总章节数
│   ├── 已完成数
│   ├── 总字数
│   ├── AI操作次数
│   └── 采纳率
├── 整体检查 Tab
│   ├── 运行检查按钮
│   └── 问题列表（类型/消息/修复/忽略）
└── 导出中心 Tab
    ├── 格式选择（MD/HTML/PDF）
    ├── 导出按钮
    ├── 预览按钮
    ├── 打开目录按钮
    └── 导出历史列表
```

#### 4.2.2 章节编辑器结构（当前实现）

```
章节编辑器
├── 顶部栏
│   ├── 返回项目按钮
│   ├── 章节标题
│   ├── 元信息（章节号/字数/完成度）
│   ├── 创建快照按钮
│   └── 保存按钮
├── 侧边栏：章节列表
└── 主编辑区
    ├── AI操作工具栏（6个按钮）
    │   ├── 续写
    │   ├── 扩写
    │   ├── 重写
    │   ├── 补论证
    │   ├── 润色
    │   └── 简化
    └── Markdown编辑区
```

### 4.2.1 用户引导流程

#### 首次使用引导
- **启动引导**：用户首次打开应用时，弹出引导流程
- **引导步骤**：
  1. 欢迎页：产品介绍与核心价值
  2. 创建第一个项目：引导创建新项目
  3. 项目底座配置：填写背景目标
  4. 大纲生成：AI 生成初始大纲
  5. 章节写作：演示章节续写操作
  6. 导出交付：演示导出流程
  7. 引导完成：展示快捷入口

#### 操作提示气泡
- **触发条件**：用户悬停或聚焦关键操作元素
- **提示内容**：操作说明、快捷键提示
- **可关闭**：用户可选择不再显示

#### 新手教程
- **入口**：设置页"新手教程"入口
- **内容**：视频/图文教程
- **进度记录**：记录完成状态

### 4.2.2 项目设置页面

#### 项目基本信息
- 项目名称编辑
- 项目描述
- 创建时间（只读）
- 项目状态：进行中/已完成/已归档

#### 项目底座配置
- 背景与目标
- 限制条件
- 术语表管理
- 风格约束

#### 项目操作
- 删除项目（需二次确认）
- 导出项目数据（备份）
- 归档/取消归档

### 4.2.3 章节模板

#### 内置模板
- 方案报告模板：背景、目标、分析、结论
- 论文模板：摘要、引言、相关工作、方法、实验、结论
- 小说模板：楔子、起因、发展、高潮、结局
- 商业计划书模板：概述、市场分析、商业模式、运营计划、财务预测

#### 模板应用
- 创建项目时选择模板
- 大纲中心应用模板
- 模板章节可自定义增删

### 4.2.4 AI 设置配置界面

#### 模型配置
- **模型选择**：下拉选择可用模型
- **API Key 配置**：输入框（加密存储）
- **模型测试**：测试连接是否正常

#### 生成参数
- **温度（Temperature）**：滑动条 0-2
- **最大 Token**：输入框，默认 4096
- **Top P**：滑动条 0-1
- **生成速度**：快速/平衡/质量

#### 预设策略
- **续写模式**：保持上下文连贯
- **创意模式**：增加创意内容
- **严谨模式**：精确事实核查

### 4.2.5 快捷键支持

#### 系统快捷键
| 功能 | 快捷键 |
|------|--------|
| 新建项目 | Ctrl/Cmd + N |
| 保存 | Ctrl/Cmd + S |
| 撤销 | Ctrl/Cmd + Z |
| 重做 | Ctrl/Cmd + Shift + Z |
| 查找 | Ctrl/Cmd + F |
| 切换主题 | Ctrl/Cmd + Shift + T |
| 打开设置 | Ctrl/Cmd + , |

#### 编辑器快捷键
| 功能 | 快捷键 |
|------|--------|
| AI 续写 | Ctrl/Cmd + Enter |
| AI 扩写 | Ctrl/Cmd + Shift + E |
| AI 重写 | Ctrl/Cmd + Shift + R |
| 生成大纲 | Ctrl/Cmd + G |
| 章节摘要 | Ctrl/Cmd + Shift + S |

#### 自定义快捷键
- 设置页提供快捷键自定义功能
- 支持保存/导入/重置快捷键配置

### 4.2.6 主题切换

#### 主题模式
- **亮色主题**：白色背景，深色文字
- **暗色主题**：深灰背景，浅色文字
- **跟随系统**：自动跟随操作系统主题

#### 主题配置位置
- 顶部工具栏主题切换按钮
- 设置页详细主题配置

### 4.2.7 数据备份导出

#### 备份内容
- 项目元数据（meta/）
- 所有章节内容（chapters/）
- 大纲（outline/）
- 快照（snapshots/）
- 配置（config.json）

#### 备份格式
- ZIP 压缩包（推荐）
- 包含清单文件（manifest.json）

#### 导入功能
- 支持导入备份 ZIP
- 校验完整性
- 冲突处理（覆盖/重命名）

核心对象：
1. Project：项目元信息与全局配置。
2. Chapter：章节正文、摘要、状态、完成度。
3. Snapshot：章节/全局快照版本。
4. Glossary：术语及标准表达。
5. CheckIssue：体检问题项及修复状态。
6. ExportJob：导出任务与产物路径。

### 4.3 建议文件架构（对用户可见）

```text
/{project_name}
  /meta
    project.md
    constraints.md
    glossary.md
  /outline
    outline.md
  /chapters
    01-intro.md
    02-problem.md
    ...
  /snapshots
    /chapter
    /global
  /artifacts
    references/
  /output
    final.md
    final.html
    final.pdf
```

### 4.4 关键业务规则

1. 所有 AI 写入必须可追溯到章节与轮次记录。
2. 每次生成前固定执行“上下文打包”，并记录所用上下文来源。
3. 用户修改章节后，标记受影响章节与检查项为“待复检”。
4. 导出前必须通过最小检查门槛（无缺章、关键术语冲突为 0）。

---

## 5. 核心流程与交互

### 5.1 主流程（入口 -> 操作 -> 反馈）

#### 完整用户路径

**路径一：首次使用**
```
启动App -> 引导流程 -> 创建第一个项目 -> 配置底座 -> 生成大纲 -> 章节写作 -> 导出交付
```

**路径二：老用户**
```
启动App -> 项目列表 -> 选择项目/新建项目 -> 继续上次进度 -> 章节写作 -> 导出交付
```

**路径三：项目设置**
```
项目首页 -> 项目设置 -> 修改配置/查看底座/管理术语 -> 保存返回
```

**路径四：个性化配置**
```
设置入口 -> AI设置/快捷键/主题 -> 调整参数 -> 立即生效
```

1. 新建项目并填写基础信息。
2. 完成项目底座配置（背景、目标、限制、术语、风格）。
3. 系统生成大纲，用户调整后确认。
4. 进入章节工作台，按章节触发 AI 续写/改写并人工编辑。
5. 系统持续更新章节摘要、完成度与上下文索引。
6. 用户触发整体检查，按问题清单修复。
7. 用户进入导出中心，一键生成并输出 PDF/MD/HTML。

### 5.1.1 快捷键操作流

| 场景 | 推荐操作 | 快捷键 |
|------|----------|--------|
| 快速续写 | 选中章节 -> Ctrl+Enter | 自动续写当前章节 |
| 批量处理 | 选中多章 -> 右键菜单 | 批量续写/删除 |
| 快速导航 | Ctrl+P | 打开章节跳转器 |
| AI 对话 | Ctrl+I | 打开 AI 对话面板 |

### 5.1.2 主题切换流

1. 点击顶部工具栏"主题"按钮
2. 选择：亮色/暗色/跟随系统
3. 立即生效，无需重启

### 5.1.3 数据备份流

1. 进入项目设置页
2. 点击"导出备份"
3. 选择保存位置
4. 生成 ZIP 文件
5. 备份完成提示

### 5.2 异常流程 A：AI 跑题或质量下降

1. 用户对生成结果不满意。
2. 系统提供”回退上一轮 + 重新生成”。
3. 用户可切换生成意图（补论证/更专业/更通俗）后再生成。
4. 可调整 AI 参数（温度、最大 token）后重试。

### 5.2.1 AI 参数调整异常处理

- **模型连接失败**：提示错误信息，提供重试/切换模型选项
- **生成超时**：提供取消/继续等待选项，保留已生成内容
- **参数不匹配**：自动调整参数到有效范围并提示用户

### 5.3 异常流程 B：章节结构被破坏

1. 检查模块发现章节目标偏离或缺失关键段落。
2. 系统提示“章节重建建议”并给出差异摘要。
3. 用户选择自动修复草案或手动编辑后复检。

### 5.4 异常流程 C：导出失败或格式异常

1. 导出任务失败时保留失败日志与中间文件。
2. 系统提示具体失败章节/资源引用。
3. 用户修复后可增量重试，无需全量重跑。

### 5.4.1 快捷键冲突处理

- **自定义快捷键冲突**：自动检测并提示冲突项
- **系统快捷键覆盖**：需确认后才可覆盖

### 5.4.2 主题切换异常

- **主题加载失败**：回退到亮色主题
- **跟随系统失败**：提示用户手动选择

### 5.4.3 备份导入异常

- **文件损坏**：提示校验失败，不执行导入
- **版本不兼容**：提示需要更高版本
- **冲突处理**：用户提供选择（覆盖/重命名）

### 5.5 关键交互原则

1. 状态可见：每章目标、进度、风险状态始终可见。
2. 反馈及时：生成、检查、导出均提供可读进度与结果摘要。
3. 路径可逆：关键动作（生成、修复）均可回滚。
4. 错误可恢复：异常均提供下一步可执行操作，不让用户”卡死”。
5. **快捷高效**：常用操作支持键盘快捷键，减少鼠标交互。
6. **个性化**：支持主题、快捷键自定义，满足不同用户习惯。
7. **可备份**：数据可导出备份，保障用户数据安全。

---

## 6. 版本与推进计划

### 6.1 V1（MVP）- 已完成 ✅

目标：打通”创建 -> 续写 -> 检查 -> 导出”闭环。
范围：P0 全量能力（单人模式）。
状态：**12个Step全部完成，2026-02-25验收通过**

### 6.1.1 V1.1（用户引导版）- 待开发

目标：降低新用户学习成本
范围：
- 首次使用引导流程
- 操作提示气泡
- 新手教程入口
- 项目设置页面基础版

### 6.1.2 V1.2（模板与配置版）- 待开发

目标：提升配置灵活性与效率
范围：
- 章节模板功能
- AI 设置配置界面
- 快捷键支持
- 主题切换

### 6.2 V2（增强）- 规划中

目标：提升上下文质量与复用效率。
范围：附件导入、术语模板、引用追踪、多模型策略。

### 6.2.1 V2.1（数据版）

目标：支持更多参考资料
范围：
- 附件/资料导入
- 链接内容抓取
- 本地文档导入

### 6.2.2 V2.2（智能版）

目标：提升 AI 协作效率
范围：
- 术语库模板化复用
- 章节间引用追踪
- 多模型策略配置
- AI 生成策略预设

### 6.3 V3（扩展）- 规划中

目标：团队化与平台化。
范围：协同、审批、模板/插件生态。

### 6.3.1 V3.1（协作版）

目标：支持基础团队协作
范围：
- 项目分享
- 评审注释
- 导出模板自定义

### 6.3.2 V3.2（生态版）

目标：开放生态能力
范围：
- 插件市场
- 自定义导出模板
- API 开放

### 6.4 里程碑与协作节奏（建议）

1. M1（第 1-2 周）：需求冻结、对象模型与目录结构冻结。
2. M2（第 3-5 周）：章节工作台 + 上下文引擎 MVP。
3. M3（第 6-7 周）：整体检查 + 快照回滚。
4. M4（第 8 周）：导出中心 + MVP 验收。

角色机制：
1. 产品负责人：提案与范围拍板。
2. 技术负责人：架构评审与可行性确认。
3. 设计负责人：交互可用性与关键路径验收。
4. QA/试用用户：场景回归与发布验收。

---

## 7. 指标与验证

### 7.1 北极星指标

1. 长文项目交付成功率（创建后最终完成导出的项目占比）。

### 7.2 过程指标

1. 章节续写采纳率（AI 生成内容被保留比例）。
2. 单项目平均回滚次数（反映生成稳定性）。
3. 整体检查问题关闭率（发现问题后完成修复比例）。
4. 从项目创建到首次可交付导出的中位时长。

### 7.3 守护指标

1. 导出失败率。
2. 连续续写跑题率（人工标记或规则判定）。
3. 严重一致性错误率（术语冲突、章节缺失）。

### 7.4 观察周期与 MVP 验收标准

观察周期：上线后连续 4 周。
MVP 验收标准：

1. 支持 >= 10 万字项目的章节化管理与导出。
2. 连续 10 轮续写后仍可通过检查（无严重跑题/结构破坏）。
3. PDF / Markdown / HTML 三格式导出成功率 >= 95%。
4. 任意 AI 写入可在 3 步内完成回滚。
5. 整体检查可识别缺章与术语不统一问题。

### 7.5 完整版功能验收标准

#### 用户引导流程
- [ ] 首次启动自动弹出引导流程
- [ ] 引导步骤可跳过/返回
- [ ] 操作提示气泡正确显示
- [ ] 新手教程可重复观看

#### 项目设置
- [ ] 可编辑项目名称和描述
- [ ] 可查看和修改底座配置
- [ ] 删除项目有二次确认
- [ ] 项目可归档/取消归档

#### 章节模板
- [ ] 内置模板可正常选择
- [ ] 模板章节结构正确生成
- [ ] 模板可应用到现有大纲

#### AI 设置
- [ ] 模型可切换选择
- [ ] API Key 加密存储
- [ ] 参数调整即时生效
- [ ] 生成策略可预设

#### 快捷键
- [ ] 系统快捷键正常工作
- [ ] 编辑器快捷键正常工作
- [ ] 自定义快捷键可保存
- [ ] 快捷键冲突有提示

#### 主题切换
- [ ] 亮色主题正常显示
- [ ] 暗色主题正常显示
- [ ] 跟随系统正常切换
- [ ] 切换无闪烁

#### 数据备份
- [ ] 备份包含所有项目数据
- [ ] ZIP 文件可正常生成
- [ ] 导入功能正常工作
- [ ] 冲突处理正确

---

## 8. 风险与对策

### 风险 1：上下文质量不稳定导致输出漂移

- 触发阈值：连续 3 次续写被用户回退。
- 对策：增加上下文打包可视化摘要、引入章节目标强约束、支持策略切换重试。

### 风险 2：工程复杂度上升导致性能与可维护性下降

- 触发阈值：关键流程（续写、检查、导出）平均响应超出目标阈值。
- 对策：模块边界强约束，先单机单人闭环，不提前引入协同和插件复杂度。

### 风险 3：用户认知负担过高，学习成本影响留存

- 触发阈值：新建项目后 24 小时内无章节推进行为比例过高。
- 对策：强化引导式流程（底座 -> 大纲 -> 章节）、默认模板、操作意图按钮替代 prompt。

---

## 附：一句话产品定义

这不是通用写作工具，而是把“长文写作”变成“项目推进”的 AI 生产系统。
